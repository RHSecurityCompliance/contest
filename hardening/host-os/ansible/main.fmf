summary: Runs ansible remediation directly on the target system
test: python3 -m lib.runtest ./test.py
result: custom
environment+:
    PYTHONPATH: ../../..
duration: 1h
recommend+:
  # ansible-core is not available on RHEL-7
  # ansible is not on RHEL-8+
  - ansible-core
  - ansible
  # needed for the ini_file ansible plugin, and more
  - rhc-worker-playbook
enabled: false

/anssi_bp28_high:
    environment+:
        PROFILE: anssi_bp28_high
    adjust:
        when: distro == rhel-7
        enabled: false
        because: RHEL-7 has anssi_nt28_high instead
    extra-summary: /CoreOS/scap-security-guide/hardening/host-os/ansible/anssi_bp28_high
    extra-nitrate: TC#0615446
    id: 3bc79691-409a-47a2-ab09-552b66befd65

/anssi_nt28_high:
    environment+:
        PROFILE: anssi_nt28_high
    adjust:
        when: distro >= rhel-8
        enabled: false
        because: RHEL-8 and newer have anssi_bp28_high instead
    extra-summary: /CoreOS/scap-security-guide/hardening/host-os/ansible/anssi_nt28_high
    extra-nitrate: TC#0615447
    id: 4c559b2a-a979-4620-b01a-0bf08f4bda80

/cis:
    environment+:
        PROFILE: cis
    extra-summary: /CoreOS/scap-security-guide/hardening/host-os/ansible/cis
    extra-nitrate: TC#0615448
    id: 91051ca5-3f8a-41a3-a6cf-7b03b561f3d3

/cis_server_l1:
    environment+:
        PROFILE: cis_server_l1
    extra-summary: /CoreOS/scap-security-guide/hardening/host-os/ansible/cis_server_l1
    extra-nitrate: TC#0615449
    id: d3e24927-f05d-41b7-a75d-cff02d060163

/cis_workstation_l1:
    environment+:
        PROFILE: cis_workstation_l1
    extra-summary: /CoreOS/scap-security-guide/hardening/host-os/ansible/cis_workstation_l1
    extra-nitrate: TC#0615450
    id: b5dc6c8b-2d66-45c7-acfd-b13eb74b21f6

/cis_workstation_l2:
    environment+:
        PROFILE: cis_workstation_l2
    extra-summary: /CoreOS/scap-security-guide/hardening/host-os/ansible/cis_workstation_l2
    extra-nitrate: TC#0615451
    id: da6f9fad-ecf6-4c9a-af42-d5d8e21f080b

/cui:
    environment+:
        PROFILE: cui
    adjust:
        when: distro == rhel-7
        enabled: false
        because: CUI doesn't have a kickstart on RHEL-7
    extra-summary: /CoreOS/scap-security-guide/hardening/host-os/ansible/cui
    extra-nitrate: TC#0615452
    id: b5e079b6-91b0-4815-8f83-e0fc64e90f70

/e8:
    environment+:
        PROFILE: e8
    extra-summary: /CoreOS/scap-security-guide/hardening/host-os/ansible/e8
    extra-nitrate: TC#0615453
    id: 30fbaaba-6989-4b15-b60c-d6523599049b

/hipaa:
    environment+:
        PROFILE: hipaa
    extra-summary: /CoreOS/scap-security-guide/hardening/host-os/ansible/hipaa
    extra-nitrate: TC#0615454
    id: bafd98c6-473b-4279-873e-c11165c1cf4b

/ism_o:
    environment+:
        PROFILE: ism_o
    adjust:
        when: distro == rhel-7
        enabled: false
        because: doesn't exist on RHEL-7
    extra-summary: /CoreOS/scap-security-guide/hardening/host-os/ansible/ism_o
    extra-nitrate: TC#0615455
    id: 866ac5c0-8f56-464d-a995-36313c77347a

/ospp:
    environment+:
        PROFILE: ospp
    extra-summary: /CoreOS/scap-security-guide/hardening/host-os/ansible/ospp
    extra-nitrate: TC#0615456
    id: f735909d-920c-4e80-84c0-11e723e5f5ea

/pci-dss:
    environment+:
        PROFILE: pci-dss
    adjust:
        when: distro == rhel-7
        enabled: false
        because: >
            RHEL-7 kickstart has a non-standard name and we decided that
            it is too close to EOL to introduce a hacky logic specifically
            for this case
    extra-summary: /CoreOS/scap-security-guide/hardening/host-os/ansible/pci-dss
    extra-nitrate: TC#0615457
    id: 5ffdce69-c34c-43ee-a6e5-ada888565f59

/stig:
    environment+:
        PROFILE: stig
    extra-summary: /CoreOS/scap-security-guide/hardening/host-os/ansible/stig
    extra-nitrate: TC#0615458
    id: 72fd6d33-edf3-4b77-8bba-6f6a2882ea8d

/stig_gui:
    environment+:
        PROFILE: stig_gui
    adjust:
        enabled: false
        because: not supported without GUI, use stig instead
    extra-summary: /CoreOS/scap-security-guide/hardening/host-os/ansible/stig_gui
    extra-nitrate: TC#0615459
    id: cfb0fe65-acf3-4239-8ff6-a4f74aefb591
