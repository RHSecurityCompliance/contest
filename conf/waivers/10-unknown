# put freshly discovered, un-investigated issues here, to suppress them
# from failing during regular runs
#
# it is expected that somebody will go over these soon(ish), investigating
# their root cause, filing issues/bugs or fixing tests as appropriate,
# eventually either removing the waivers or moving them to other files

# Ansible
#
# https://github.com/ComplianceAsCode/content/issues/13128
/hardening/ansible/.+/network_nmcli_permissions
    rhel == 9
# https://github.com/ComplianceAsCode/content/issues/13129
/hardening/ansible/with-gui/stig_gui/sysctl_net_ipv4_conf_all_forwarding
    rhel == 8

# https://github.com/ComplianceAsCode/content/issues/10901
# not sure what enables the service, but second remediation fixes the problem
# and we cannot easily do double-remediation with OAA
/hardening/anaconda/with-gui/[^/]+/service_rpcbind_disabled
    rhel == 8

# /per-rule (Automatus rule mode) fails
# https://github.com/ComplianceAsCode/content/issues/13126
/per-rule/.+/accounts_password_set_max_life_root/correct.pass
/per-rule/.+/accounts_password_set_max_life_root/wrong.fail
/per-rule/.+/postfix_client_configure_mail_alias/correct.pass
/per-rule/.+/package_quagga_removed/package-installed.fail
/per-rule/.+/package_rsh-server_removed/package-installed.fail
/per-rule/.+/package_rsh_removed/package-installed.fail
/per-rule/.+/package_mcafeetp_installed/package-installed.pass
    True
/per-rule/.+/grub2_audit_backlog_limit_argument/correct_grubenv.pass
/per-rule/.+/grub2_password/invalid_username.fail
/per-rule/.+/harden_sshd_ciphers_openssh_conf_crypto_policy/stig_correct.pass
/per-rule/.+/harden_sshd_ciphers_openssh_conf_crypto_policy/stig_correct_followed_by_incorrect_commented.pass
/per-rule/.+/sudo_add_umask/0027_var_multiple_values.pass
    rhel == 8
/per-rule/.+/package_xinetd_removed/package-installed.fail
/per-rule/.+/package_ypbind_removed/package-installed.fail
/per-rule/.+/package_ypserv_removed/package-installed.fail
/per-rule/.+/service_telnet_disabled/service_disabled.pass
    rhel == 9

# DISA Alignment waivers
#
# https://github.com/ComplianceAsCode/content/issues/12561
/scanning/disa-alignment/.*/logind_session_timeout
    rhel == 8
# https://github.com/ComplianceAsCode/content/issues/13033
/scanning/disa-alignment/(oscap|ansible)/file_permission_user_init_files_root
    rhel == 8
# https://github.com/ComplianceAsCode/content/issues/13034
/scanning/disa-alignment/.*/grub2_pti_argument
/scanning/disa-alignment/.*/grub2_vsyscall_argument
/scanning/disa-alignment/.*/grub2_page_poison_argument
/scanning/disa-alignment/.*/grub2_slub_debug_argument
/scanning/disa-alignment/.*/grub2_audit_argument
/scanning/disa-alignment/.*/grub2_audit_backlog_limit_argument
    rhel == 8
# https://github.com/ComplianceAsCode/content/issues/11804
/scanning/disa-alignment/.*/harden_sshd_ciphers_openssh_conf_crypto_policy
# https://github.com/ComplianceAsCode/content/issues/11692
/scanning/disa-alignment/.*/accounts_password_pam_pwhistory_remember_system_auth
# https://github.com/ComplianceAsCode/content/issues/11695
/scanning/disa-alignment/.*/service_pcscd_enabled
# https://github.com/ComplianceAsCode/content/issues/11698
/scanning/disa-alignment/.*/no_shelllogin_for_systemaccounts
# https://github.com/ComplianceAsCode/content/issues/11802
/scanning/disa-alignment/.*/CCE-88173-0
# https://github.com/ComplianceAsCode/content/issues/11703
/scanning/disa-alignment/.*/file_permissions_library_dirs
# https://github.com/ComplianceAsCode/content/issues/12573
/scanning/disa-alignment/.*/sshd_set_keepalive
# https://github.com/ComplianceAsCode/content/issues/11693
/scanning/disa-alignment/(oscap|ansible)/accounts_password_pam_retry
# https://github.com/ComplianceAsCode/content/issues/11802
/scanning/disa-alignment/[^/]+/auditd_audispd_configure_sufficiently_large_partition
    rhel == 9
# https://github.com/ComplianceAsCode/content/issues/13108
/scanning/disa-alignment/.*/configure_crypto_policy
/scanning/disa-alignment/.*/configure_kerberos_crypto_policy
/scanning/disa-alignment/.*/configure_libreswan_crypto_policy
    rhel == 9 or rhel == 8
# https://github.com/ComplianceAsCode/content/issues/13109
/scanning/disa-alignment/.+/file_permissions_sshd_config
/scanning/disa-alignment/.+/file_permissions_sshd_drop_in_config
    rhel == 9
# https://github.com/ComplianceAsCode/content/issues/13110
/scanning/disa-alignment/anaconda/ensure_gpgcheck_globally_activated
    rhel == 8
# https://github.com/ComplianceAsCode/content/issues/13100
/hardening/.*/file_permission_user_init_files_root
    True
# https://github.com/ComplianceAsCode/content/issues/13107
/per-rule/.+/oscap/package_bind_removed/package-installed.fail
    rhel == 9

# Image Builder
#
# https://github.com/ComplianceAsCode/content/issues/13127
/hardening/image-builder(/.+)?/anssi_[^/]+/mount_option_tmp_noexec
/hardening/image-builder(/.+)?/anssi_[^/]+/sebool_polyinstantiation_enabled
/hardening/image-builder(/.+)?/hipaa/sebool_selinuxuser_execmod
    True

# vim: syntax=python
