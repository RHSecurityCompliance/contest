# put freshly discovered, un-investigated issues here, to suppress them
# from failing during regular runs
#
# it is expected that somebody will go over these soon(ish), investigating
# their root cause, filing issues/bugs or fixing tests as appropriate,
# eventually either removing the waivers or moving them to other files

# https://github.com/ComplianceAsCode/content/issues/12766

/hardening/anaconda/stig/file_permissions_etc_audit_rulesd
/hardening/anaconda/with-gui/stig_gui/file_permissions_etc_audit_rulesd
/scanning/disa-alignment/anaconda/file_permissions_etc_audit_rulesd
    rhel <= 9

/hardening/image-builder/stig/file_permissions_etc_audit_rulesd
    True

/hardening/kickstart/stig/file_permissions_etc_audit_rulesd
/hardening/kickstart/with-gui/stig_gui/file_permissions_etc_audit_rulesd
    rhel == 10

# ssh either doesn't start up, or gets blocked, possibly related
# to new firewalld rules being added?
# https://github.com/ComplianceAsCode/content/pull/10573
# (happens only with GUI)
#
# or perhaps one of
# https://github.com/ComplianceAsCode/content/issues/10592
# https://github.com/ComplianceAsCode/content/issues/10593
# https://github.com/ComplianceAsCode/content/issues/10594
/hardening/oscap/with-gui/cis_workstation_l[12]
    status == 'error'

# https://github.com/ComplianceAsCode/content/issues/12768
/hardening/ansible/stig/accounts_password_pam_retry
/hardening/ansible/with-gui/stig_gui/accounts_password_pam_retry
/hardening/host-os/ansible/stig/accounts_password_pam_retry
    rhel == 10

# https://github.com/ComplianceAsCode/content/issues/12769
/hardening/host-os/oscap/anssi_bp28_high/set_password_hashing_algorithm_systemauth
/hardening/host-os/oscap/ism_o/set_password_hashing_algorithm_systemauth
/hardening/image-builder/anssi_bp28_high/set_password_hashing_algorithm_systemauth
/hardening/image-builder/ism_o/set_password_hashing_algorithm_systemauth
/hardening/kickstart/anssi_bp28_high/set_password_hashing_algorithm_systemauth
/hardening/kickstart/ism_o/set_password_hashing_algorithm_systemauth
/hardening/oscap/anssi_bp28_high/set_password_hashing_algorithm_systemauth
/hardening/oscap/ism_o/set_password_hashing_algorithm_systemauth
    rhel == 10

# Ansible TODO: completely unknown, investigate and sort
#
# all RHELs
/hardening(/host-os)?/ansible/.+/audit_rules_usergroup_modification
    True
# RHEL-9 only
# (possibly because of missing Ansible remediation?)
/hardening/ansible/.+/network_nmcli_permissions
    rhel == 9
# RHEL-8 or 9
/hardening(/host-os)?/ansible/.+/audit_rules_unsuccessful_file_modification
    rhel == 8 or rhel == 9
# RHEL-8
/hardening/ansible/with-gui/stig_gui/sysctl_net_ipv4_conf_all_forwarding
    rhel == 8

# Ansible, on 9.0 / 9.2 / 9.6 / 8.10
# https://github.com/ComplianceAsCode/content/issues/12831
# https://github.com/ComplianceAsCode/content/issues/12870
/hardening/host-os/ansible/anssi_.+/timer_dnf-automatic_enabled
/hardening/host-os/ansible/anssi_.+/timer_logrotate_enabled
    True

# https://github.com/ComplianceAsCode/content/issues/10901
# not sure what enables the service, but second remediation fixes the problem
# TODO: we do run double remediation, but this still sometimes fails,
#       investigate why
/hardening/anaconda/with-gui/[^/]+/service_rpcbind_disabled
    rhel == 8

# /per-rule (Automatus rule mode) waivers
#
# TODO: all of these are unknown and need investigation
/per-rule/.+/accounts_password_set_max_life_root/correct.pass
/per-rule/.+/accounts_password_set_max_life_root/wrong.fail
/per-rule/.+/postfix_client_configure_mail_alias/correct.pass
    True
/per-rule/.+/grub2_audit_backlog_limit_argument/correct_grubenv.pass
/per-rule/.+/grub2_password/invalid_username.fail
/per-rule/.+/harden_sshd_ciphers_openssh_conf_crypto_policy/stig_correct.pass
/per-rule/.+/harden_sshd_ciphers_openssh_conf_crypto_policy/stig_correct_followed_by_incorrect_commented.pass
/per-rule/.+/sudo_add_umask/0027_var_multiple_values.pass
    rhel == 8
/per-rule/.+/directory_permissions_var_log_audit/correct_value_0700.pass
/per-rule/.+/directory_permissions_var_log_audit/incorrect_value_0700.fail
/per-rule/.+/dconf_gnome_lock_screen_on_smartcard_removal/wrong_value.fail
/per-rule/.+/file_ownership_var_log_audit_stig/correct_value_default_file.pass
/per-rule/.+/tftpd_uses_secure_mode/correct.pass
/per-rule/.+/tftpd_uses_secure_mode/wrong.fail
    rhel == 9
# unit tests that try installing packages that don't even exist in the repos,
# or messing with services of packages that are not installed
/per-rule/.+/package_quagga_removed/package-installed.fail
/per-rule/.+/package_rsh-server_removed/package-installed.fail
/per-rule/.+/package_rsh_removed/package-installed.fail
/per-rule/.+/package_mcafeetp_installed/package-installed.pass
    True
/per-rule/.+/package_talk_removed/package-installed.fail
    rhel == 8
/per-rule/.+/package_xinetd_removed/package-installed.fail
/per-rule/.+/package_ypbind_removed/package-installed.fail
/per-rule/.+/package_ypserv_removed/package-installed.fail
/per-rule/.+/service_telnet_disabled/service_disabled.pass
    rhel == 9
# Beaker and host-os seem to randomly fail any services enabled
# or packages installed - TODO investigate remediation script outputs
# to figure out why
/hardening/host-os/oscap/[^/]+/service_.+_enabled
/hardening/host-os/oscap/[^/]+/timer_.+_enabled
/hardening/host-os/oscap/[^/]+/package_.+_installed
    True

# https://github.com/ComplianceAsCode/content/issues/12874
/per-rule/.+/accounts_root_gid_zero/other_user_uid_0.fail
    True

# RHEL-10 specific /per-rule issues
#
# audit rules, https://github.com/ComplianceAsCode/content/pull/12867
/per-rule/.+/audit_rules_unsuccessful_file_modification_open_rule_order/ordered_arch.pass
/per-rule/.+/audit_rules_unsuccessful_file_modification_open_rule_order/ordered_filter.pass
/per-rule/.+/audit_rules_unsuccessful_file_modification_openat_rule_order/ordered_arch.pass
/per-rule/.+/audit_rules_unsuccessful_file_modification_openat_rule_order/ordered_filter.pass
/per-rule/.+/audit_rules_unsuccessful_file_modification_openat_o_creat/o_creat_last.pass
/per-rule/.+/audit_rules_unsuccessful_file_modification_openat_o_creat/o_creat_rules.pass
/per-rule/.+/audit_rules_unsuccessful_file_modification_openat_o_trunc_write/o_trunc.pass
# https://github.com/ComplianceAsCode/content/issues/12880
/per-rule/.+/audit_rules_privileged_commands_unix2_chkpwd/only_chkpwd_rule.fail
# https://github.com/ComplianceAsCode/content/issues/12875
/per-rule/.+/package_xinetd_removed/package-installed.fail
# https://github.com/ComplianceAsCode/content/issues/12878
/per-rule/.+/coredump_disable_storage/coredumps_storage_none.pass
# https://github.com/ComplianceAsCode/content/issues/12876
/per-rule/.+/logind_session_timeout/not_configured.fail
# https://github.com/ComplianceAsCode/content/issues/12879
/per-rule/.+/grub2_enable_fips_mode/grub_cmdline_linux_correct_value.pass
# https://github.com/ComplianceAsCode/content/issues/12877
/per-rule/.+/kernel_module_sctp_disabled/missing_blacklist.fail
    rhel == 10

# DISA Alignment waivers
#
# https://github.com/ComplianceAsCode/content/issues/12561
/scanning/disa-alignment/.*/logind_session_timeout
    rhel == 8
# https://github.com/ComplianceAsCode/content/issues/13020
/scanning/disa-alignment/.*/accounts_passwords_pam_faillock_interval
/scanning/disa-alignment/.*/accounts_passwords_pam_faillock_silent
/scanning/disa-alignment/.*/accounts_passwords_pam_faillock_unlock_time
    rhel == 8
# https://github.com/ComplianceAsCode/content/issues/12149
/scanning/disa-alignment/.*/harden_sshd_ciphers_opensshserver_conf_crypto_policy
    rhel == 9
# https://github.com/ComplianceAsCode/content/issues/11804
/scanning/disa-alignment/.*/harden_sshd_ciphers_openssh_conf_crypto_policy
# https://github.com/ComplianceAsCode/content/issues/11692
/scanning/disa-alignment/.*/accounts_password_pam_pwhistory_remember_system_auth
# https://github.com/ComplianceAsCode/content/issues/11695
/scanning/disa-alignment/.*/service_pcscd_enabled
# https://github.com/ComplianceAsCode/content/issues/11698
/scanning/disa-alignment/.*/no_shelllogin_for_systemaccounts
# https://github.com/ComplianceAsCode/content/issues/11802
/scanning/disa-alignment/.*/CCE-88173-0
# https://github.com/ComplianceAsCode/content/issues/11703
/scanning/disa-alignment/.*/file_permissions_library_dirs
# https://github.com/ComplianceAsCode/content/issues/12573
/scanning/disa-alignment/.*/sshd_set_keepalive
# https://github.com/ComplianceAsCode/content/issues/11693
/scanning/disa-alignment/(oscap|ansible)/accounts_password_pam_retry
    rhel == 9
# https://github.com/ComplianceAsCode/content/issues/11802
/scanning/disa-alignment/[^/]+/auditd_audispd_configure_sufficiently_large_partition
    True

# Image Builder
#
# TODO: file issues ?
/hardening/image-builder(/.+)?/anssi_[^/]+/mount_option_tmp_noexec
/hardening/image-builder(/.+)?/anssi_[^/]+/sebool_polyinstantiation_enabled
    True
/hardening/image-builder(/.+)?/hipaa/sebool_selinuxuser_execmod
    rhel == 9

# https://github.com/ComplianceAsCode/content/issues/12907
/hardening/.+/sssd_enable_smartcards
/hardening/.+/playbook: Enable Smartcards in SSSD.*
    rhel == 10

# vim: syntax=python
